--- 
frameworkVersion: ">=1.28.0 <2.0.0"
functions: 
  forgesense: 
    handler: cmd/main
    name: prospectbot-${self:provider.stage}
    events:
      - schedule:
          rate: rate(10 minutes)
          enabled: true
          name: run-prospectbot-${opt:stage, 'dev'}
          description: 'Checks Github for new software releases'
package:
 exclude:
   - ../**
 include:
   - ../cmd/*
   - ../internal/*
provider: 
  deploymentBucket: 
    name: serverless-deployment-stacks
    serverSideEncryption: AES256
  deploymentPrefix: forgesense
  memorySize: 512
  name: aws
  region: ${opt:region, 'us-east-1'}
  runtime: go1.x
  stage: ${opt:stage, 'dev'}
  timeout: 60
  versionFunctions: false
  vpc: 
    securityGroupIds: 
      - sg-0a004076bb0b36504
    subnetIds: 
      - subnet-0fd39854
      - subnet-c436a7a1
      - subnet-d61aa3da
  iamRoleStatements:
      - Effect: "Allow"
        Action:
          - "dynamodb:PutItem"
          - "dynamodb:ListTables"
          - "dynamodb:GetItem"
          - "dynamodb:Query"
          - "dynamodb:UpdateItem"
          - "dynamodb:Scan"
        Resource: "*"
service: prospectbot
